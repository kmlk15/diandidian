@( bag: models.Bag)(implicit  statusNameList: List[String] = List( "计划中"  ,"准备前往","过去背包"  ))

@import models.BagHelp.defaultPlanName
@import models.BagHelp.defaultStatusName
@script={
 <script type="text/javascript" src="@routes.Assets.at("javascripts/bag.js")"></script>

}

@statusOptionDisplay( statusOption : Option[models.Status])={

@if( statusOption == None){

}else{
  @statusDisplay( statusOption.get )
}

}

@statusDisplay( status: models.Status)={

					<h3 class="accordion-header  @if(status.name==defaultStatusName  ){   state-active } "   >@status.name
					@if( status.name != defaultStatusName   ){
						-@status.map.size个
					}else{
					    <a href="#" class="addNewPlan" >加新背包</a>
					}
					 </h3>
						<div class="accordion accordion-content" @if(status.name==defaultStatusName  ){ style="display:block;"} >
					 
						@defining( status.map.keySet.toList.sorted) { keylist =>
						@for( key <- keylist  ; plan <- status.map.get(key)  ){
							<h4 class="accordion-header @if(plan.name== keylist.head  ){   state-active } " >@plan.name  <span>-</span>
							<small><span>@plan.list.size</span>个景点</small>
							
							 </h4>
							<div class="accordion-content clearfix  @if(status.name==defaultStatusName && plan.name== keylist.head ){ state-active }" @if(status.name==defaultStatusName && plan.name== keylist.head ){ style="display:block;"}  >
								<ul @if(status.name==defaultStatusName && plan.name== keylist.head ){class="open"}>
								@for( simpleLocation <- plan.list.reverse   ){
								<li> 
								<table cellpadding="0" cellspacing="0">
								<tbody><tr>
								<td>@simpleLocation.name</td>
								@if( status.name != "过去背包" ){
								<td class="del">
								<a href="?locationId=@helper.urlEncode(simpleLocation.id)&statusName=@helper.urlEncode(status.name)&planName=@helper.urlEncode(plan.name)"  ></a>
								</td>
								}
								</tr></tbody></table>
								</li>
								}
								</ul>
								@if( status.name != "过去背包" ){
								 
							     <a   href="?statusName=@helper.urlEncode(status.name)&planName=@helper.urlEncode(plan.name)" class="setPlan" @if(status.name==defaultStatusName && plan.name== keylist.head ){ }else{  }> 编辑</a>
							 
								 <a class="plan"  href="/plan/?statusName=@helper.urlEncode(status.name)&planName=@helper.urlEncode(plan.name)">计划行程</a>
								}
							</div>
							} 
							}
						</div>

}
@main( "登录用户" , script){

	<div id="content">
		<div id="sidebar">
<div id="my-bag">
					<h2>我的背包:  </h2>
					<h3><small><span id="currentStatus"></span> <span id="currentPlan"></span></small></h3>
 				<div class="accordion">
 				  	@for( key <- statusNameList ){
						 @statusOptionDisplay( bag.map.get(key)  )
					    }
					</div><!-- end accordion -->
				</div><!-- end my-bag -->
</div>
<div id="main">
@bag
</div>
</div>
}